"use strict";(self["webpackChunkticketing"]=self["webpackChunkticketing"]||[]).push([[844],{2157:function(t,e,i){i.d(e,{n:function(){return o}});const o=t=>{for(var e in t)return!1;return!0}},897:function(t,e,i){i.d(e,{Z:function(){return V}});var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-container",[i("v-dialog",{attrs:{"max-width":"900"},model:{value:t.solutionsDialog,callback:function(e){t.solutionsDialog=e},expression:"solutionsDialog"}},[t.isAddNew?i("div",[i("div",{staticClass:"modalHeader"},[i("v-btn",{staticClass:"text-capitalize",attrs:{color:"success",small:"",disabled:t.loading},on:{click:function(e){t.solutionDialog=!0}}},[i("span",[t._v("Add New")])])],1),i("v-divider")],1):t._e(),i("v-data-table",{staticClass:"elevation-1 rounded-t-0",attrs:{headers:t.headers,items:t.solutions,"items-per-page":5,loading:t.loading,"loading-text":"Loading... Please wait"},scopedSlots:t._u([{key:"item.remarks",fn:function(e){var o=e.item;return[i("div",{staticClass:"text-truncate",staticStyle:{"max-width":"250px"}},[t._v(" "+t._s(o.remarks)+" ")])]}},{key:"item.created_at",fn:function(e){var o=e.item;return[i("span",[t._v(t._s(t.setCreatedAtFormat(o.created_at)))])]}}],null,!0)})],1),t.solutionDialog?i("v-dialog",{attrs:{persistent:t.isPersistent,"max-width":"500px"},model:{value:t.solutionDialog,callback:function(e){t.solutionDialog=e},expression:"solutionDialog"}},[i("v-form",{ref:"solutionForm",on:{submit:function(e){return e.preventDefault(),t.onSubmit.apply(null,arguments)}}},[i("v-card",{attrs:{disabled:t.loadingForm}},[i("v-card-title",[t._v(" Solution ")]),i("v-card-subtitle",[i("small",[t._v("Note: All fields are required.")])]),i("v-card-text",[i("v-row",[i("v-col",{attrs:{cols:"12"}},[i("v-text-field",{ref:"keyword",attrs:{label:"Keyword",rules:t.saveStatus?[t.rules.required,t.rules.minimum(2),t.rules.maximum(100)]:[],"hide-details":"auto",outlined:"",dense:""},model:{value:t.solutionForm.keyword,callback:function(e){t.$set(t.solutionForm,"keyword",e)},expression:"solutionForm.keyword"}})],1),i("v-col",{attrs:{cols:"12"}},[i("v-textarea",{ref:"remarks",attrs:{label:"Remarks",rules:t.saveStatus?[t.rules.required,t.rules.minimum(2),t.rules.maximum(5e3)]:[],"hide-details":"auto",rows:"4",outlined:"",dense:""},model:{value:t.solutionForm.remarks,callback:function(e){t.$set(t.solutionForm,"remarks",e)},expression:"solutionForm.remarks"}})],1)],1)],1),i("v-card-actions",[i("v-spacer"),i("v-btn",{on:{click:function(e){t.solutionDialog=!1}}},[t._v(" Close ")]),i("v-btn",{attrs:{color:"success",type:"submit"}},[t._v(" Save ")])],1)],1)],1)],1):t._e()],1)},s=[],a=i(629),r=i(381),l=i.n(r),n=i(3659),c={name:"Solutions",props:["isAddNew"],data:()=>({headers:[{text:"Keyword",value:"keyword"},{text:"Remarks",value:"remarks"},{text:"Date Created",value:"created_at"},{text:"Action",value:"action",sortable:!1}],rules:n.Z,solutionDialog:!1,isPersistent:!1,solutionForm:{ticket_id:null,keyword:null,remarks:null},saveStatus:!1}),created(){this.getRecords()},computed:{...(0,a.rn)(["loading","solutions"]),...(0,a.rn)("myQueue",["loadingForm"]),solutionsDialog:{get:function(){return!0},set:function(){this.$emit("closeSolutionsDialog")}}},methods:{...(0,a.nv)("myQueue",["createSolution"]),async getRecords(){this.$store.commit("setSolutions",[]),await this.$store.dispatch("getSolutions",this.$route.params.id),this.solutionForm.ticket_id=this.$route.params.id},async onSubmit(){this.saveStatus=!0,await new Promise((t=>setTimeout(t,200))),this.loadingForm||this.$refs.solutionForm.validate()&&(this.isPersistent=!0,await this.createSolution(this.solutionForm),this.solutionsDialog=!1,this.solutionDialog=!1,this.$refs.solutionForm.reset(),this.isPersistent=!1)},setCreatedAtFormat(t){return l()(t).format("MMM D, YYYY h:mm A")}},watch:{solutionDialog(t){t&&setTimeout((()=>{this.$refs.keyword.focus()}),200)}}},u=c,d=i(1001),m=i(3453),v=i.n(m),g=i(680),f=i(3237),h=i(7118),p=i(2102),_=i(4228),k=i(4998),D=i(4497),b=i(1418),x=i(6232),y=i(2877),S=i(9762),w=i(5978),C=i(4350),Z=(0,d.Z)(u,o,s,!1,null,"4dbcd4a5",null),V=Z.exports;v()(Z,{VBtn:g.Z,VCard:f.Z,VCardActions:h.h7,VCardSubtitle:h.Qq,VCardText:h.ZB,VCardTitle:h.EB,VCol:p.Z,VContainer:_.Z,VDataTable:k.Z,VDialog:D.Z,VDivider:b.Z,VForm:x.Z,VRow:y.Z,VSpacer:S.Z,VTextField:w.Z,VTextarea:C.Z})},4439:function(t,e,i){i.d(e,{Z:function(){return h}});var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-dialog",{attrs:{"max-width":"900"},model:{value:t.ticketLogsDialog,callback:function(e){t.ticketLogsDialog=e},expression:"ticketLogsDialog"}},[i("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.headers,items:t.ticketLogs,"items-per-page":5,loading:t.loading,"loading-text":"Loading... Please wait"},scopedSlots:t._u([{key:"item.created_at",fn:function(e){var o=e.item;return[i("span",[t._v(t._s(t.setCreatedAtFormat(o.created_at)))])]}}],null,!0)})],1)},s=[],a=i(629),r=i(381),l=i.n(r),n={name:"TicketLogs",data:()=>({headers:[{text:"Category",value:"category.name"},{text:"Status",value:"ticket_status.name"},{text:"Priority",value:"priority_status.name"},{text:"Department",value:"department.name"},{text:"Assigned To",value:"assignee.full_name"},{text:"Date Created",value:"created_at"}]}),created(){this.$store.commit("setTicketLogs",[]),this.$store.dispatch("getTicketLogs",this.$route.params.id)},computed:{...(0,a.rn)(["loading","ticketLogs"]),ticketLogsDialog:{get:function(){return!0},set:function(){this.$emit("closeTicketLogsDialog")}}},methods:{setCreatedAtFormat(t){return l()(t).format("MMM D, YYYY h:mm A")}}},c=n,u=i(1001),d=i(3453),m=i.n(d),v=i(4998),g=i(4497),f=(0,u.Z)(c,o,s,!1,null,null,null),h=f.exports;m()(f,{VDataTable:v.Z,VDialog:g.Z})},8594:function(t,e,i){i.r(e),i.d(e,{default:function(){return Y}});var o=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("v-container",{attrs:{fluid:""}},[o("v-row",[o("v-col",{attrs:{cols:"12",md:"8"}},[o("v-card",[t.loadingRecords?o("div",[o("v-card-text",[o("v-progress-linear",{attrs:{indeterminate:"",color:"grey"}}),o("br"),o("v-progress-linear",{attrs:{indeterminate:"",color:"grey"}}),o("br"),o("v-progress-linear",{attrs:{indeterminate:"",color:"grey"}})],1)],1):o("div",[o("v-card-subtitle",{staticClass:"d-flex"},[o("v-icon",{staticClass:"ml-2 mr-5"},[t._v("mdi-email-outline")]),o("div",[o("h3",{staticClass:"font-weight-black"},[t._v(" Ticket #"+t._s(t.id)+" - "+t._s(t.subject)+" ")]),t._v(" "+t._s(t._f("dateFormat")(t.createdAt))+" ("+t._s(t._f("setFromNow")(t.createdAt))+") ")]),o("v-spacer"),o("router-link",{attrs:{to:{name:"MyTeam"}}},[t._v("Back")])],1),o("v-card-text",{staticClass:"d-flex"},[o("v-img",{staticClass:"mr-3 rounded",attrs:{src:i(6229),"max-height":"40","max-width":"40"}}),o("div",[o("div",{staticClass:"font-weight-bold"},[t._v(t._s(t.client))]),o("div",[t._v(t._s(t.email))]),o("div",{directives:[{name:"show",rawName:"v-show",value:t.loanNumber&&t.project&&t.unit&&t.contact,expression:"loanNumber && project && unit && contact"}]},[o("br"),o("div",[o("span",{staticClass:"font-weight-bold"},[t._v("Loan No.:")]),t._v(" "+t._s(t.loanNumber))]),o("div",[o("span",{staticClass:"font-weight-bold"},[t._v("Project:")]),t._v(" "+t._s(t.project))]),o("div",[o("span",{staticClass:"font-weight-bold"},[t._v("Unit/Lot No.:")]),t._v(" "+t._s(t.unit))]),o("div",[o("span",{staticClass:"font-weight-bold"},[t._v("Contact:")]),t._v(" "+t._s(t.contact))])])])],1),o("v-card-text",{staticClass:"d-flex"},[o("v-icon",{staticClass:"ml-3 mr-6",attrs:{small:""}},[t._v("mdi-email-outline")]),o("div",{staticClass:"pre-formatted"},[t._v(" "+t._s(t.description)+" ")])],1),o("v-card-actions",[o("v-btn",{staticClass:"text-capitalize ml-15",attrs:{small:""},on:{click:function(e){t.ticketLogsDialog=!0}}},[o("v-icon",{attrs:{small:""}},[t._v("mdi-file-document-outline")]),t._v(" View Logs ")],1),t.isShowSolutionBtn?o("v-btn",{staticClass:"text-capitalize",attrs:{small:""},on:{click:function(e){t.solutionsDialog=!0}}},[o("v-icon",{attrs:{small:""}},[t._v("mdi-book-open-page-variant-outline")]),t._v("  Solution ")],1):t._e()],1)],1)])],1),o("v-col",{attrs:{cols:"12",md:"4"}},[o("v-form",{ref:"form"},[o("v-card",{attrs:{disabled:t.loadingForm}},[o("div",[o("v-card-subtitle",{staticClass:"text-uppercase font-weight-bold"},[t._v(" Properties "),o("v-divider")],1),o("v-card-text",[o("v-row",[o("v-col",{attrs:{cols:"12"}},[o("v-autocomplete",{ref:"category",attrs:{rules:[t.rules.required],items:t.categories,"item-text":"name","item-value":"id",label:"Category","hide-details":"auto"},model:{value:t.form.category,callback:function(e){t.$set(t.form,"category",e)},expression:"form.category"}})],1)],1),o("v-row",[o("v-col",{attrs:{cols:"12"}},[o("v-select",{ref:"ticketStatus",attrs:{rules:[t.rules.required],items:t.ticketStatuses,"item-text":"name","item-value":"id",label:"Status","hide-details":"auto",disabled:""},model:{value:t.form.ticketStatus,callback:function(e){t.$set(t.form,"ticketStatus",e)},expression:"form.ticketStatus"}})],1)],1),o("v-row",[o("v-col",{attrs:{cols:"12"}},[o("v-select",{ref:"priorityStatus",attrs:{rules:[t.rules.required],items:t.priorityStatuses,"item-text":"name","item-value":"id",label:"Priority","hide-details":"auto"},on:{change:function(e){return t.setPriority(t.priorityStatuses)}},scopedSlots:t._u([{key:"selection",fn:function(e){var i=e.item;return[o("v-icon",{staticClass:"mr-1",attrs:{small:"",color:t.getPriorityColor(i.id)}},[t._v("mdi-square")]),t._v(" "+t._s(i.name)+" "),5!=i.id?o("span",[t._v(" ("+t._s(i.hours)+" hrs)")]):t._e()]}},{key:"item",fn:function(e){var i=e.item;return[o("v-icon",{staticClass:"mr-1",attrs:{small:"",color:t.getPriorityColor(i.id)}},[t._v("mdi-square")]),t._v(t._s(i.name)+" "),5!=i.id?o("span",[t._v(" ("+t._s(i.hours)+" hrs)")]):t._e()]}}]),model:{value:t.form.priorityStatus,callback:function(e){t.$set(t.form,"priorityStatus",e)},expression:"form.priorityStatus"}})],1)],1),o("v-row",[o("v-col",{attrs:{cols:"12"}},[o("v-text-field",{ref:"dueDate",attrs:{label:"Due date*",rules:[t.rules.required,t.validDueDate],type:"datetime-local","hide-details":"auto",disabled:5!=t.form.priorityStatus},model:{value:t.form.dueDate,callback:function(e){t.$set(t.form,"dueDate",e)},expression:"form.dueDate"}})],1)],1),o("v-row",[o("v-col",{attrs:{cols:"12"}},[o("v-autocomplete",{ref:"department",attrs:{rules:[t.rules.required],items:t.departments,"item-text":"name","item-value":"id",label:"Department","hide-details":"auto"},on:{change:t.setAgents},model:{value:t.form.department,callback:function(e){t.$set(t.form,"department",e)},expression:"form.department"}})],1)],1),o("v-row",[o("v-col",{attrs:{cols:"12"}},[o("v-autocomplete",{ref:"agent",attrs:{items:t.agents,"item-text":"full_name","item-value":"id",label:"Agent","hide-details":"auto"},on:{change:t.setAgent},model:{value:t.form.agent,callback:function(e){t.$set(t.form,"agent",e)},expression:"form.agent"}})],1)],1),o("v-row",[o("v-col",{attrs:{cols:"12"}},[o("v-btn",{attrs:{color:"primary",block:""},on:{click:function(e){t.confirmationDialog=!0}}},[t._v(" Update ")])],1)],1)],1)],1)])],1)],1)],1),t.solutionsDialog?o("solutions",{on:{closeSolutionsDialog:t.closeSolutionsDialog}}):t._e(),t.ticketLogsDialog?o("ticket-logs",{on:{closeTicketLogsDialog:t.closeTicketLogsDialog}}):t._e(),t.confirmationDialog?o("confirmation-message",{attrs:{confirmationData:t.confirmationData},on:{closeConfirmationDialog:t.closeConfirmationDialog,onSubmit:t.onSubmit}}):t._e()],1)},s=[],a=i(629),r=i(2157),l=i(381),n=i.n(l),c=i(3659),u=i(897),d=i(4439),m=i(5081),v={components:{TicketLogs:d.Z,Solutions:u.Z,ConfirmationMessage:m.Z},data:()=>({rules:c.Z,subject:null,createdAt:null,client:null,email:null,loanNumber:null,project:null,unit:null,contact:null,description:null,id:null,form:{category:null,ticketStatus:null,priorityStatus:null,department:null,agent:null,dueDate:null},solutionsDialog:!1,ticketLogsDialog:!1,isShowSolutionBtn:!1,confirmationDialog:!1,confirmationData:{title:"Are you sure you want to update?",text:"This action cannot be undone.",closeBtnText:"Cancel",closeBtnColor:"gray",saveBtnText:"Update",saveBtnColor:"primary"},invalidDueDateText:null}),created(){this.getRecord()},computed:{...(0,a.rn)("myTeam",["loadingRecords","loadingForm","record","categories","ticketStatuses","priorityStatuses","departments","agents","errors"])},methods:{...(0,a.nv)("myTeam",["getAgents","editRecord","updateRecord"]),async getRecord(){this.$store.commit("myTeam/setRecord",[]),this.$store.commit("myTeam/setAgents",[]),await this.editRecord(this.$route.params.id),Object.keys(this.record).length&&(this.id=this.record.id,this.subject=this.record.subject,this.createdAt=this.record.created_at,this.client=this.record.client,this.email=this.record.email,this.loanNumber=this.record.loan_number,this.project=this.record.project,this.unit=this.record.unit,this.contact=this.record.contact,this.description=this.record.description,this.form.category=this.record.category_id,this.form.ticketStatus=this.record.ticket_status_id,this.form.priorityStatus=this.record.priority_status_id,this.form.dueDate=n()(this.record.due_date).format("YYYY-MM-DDTkk:mm"),this.form.department=this.record.department_id,this.form.agent=this.record.assigned_to,4!=this.record.ticket_status_id&&5!=this.record.ticket_status_id||(this.isShowSolutionBtn=!0))},getPriorityColor(t){switch(t){case 1:return"green";case 2:return"blue";case 3:return"orange";case 4:return"red";default:return"grey"}},setPriority(t){const e=t.find((t=>t.id===this.form.priorityStatus));this.form.dueDate=n()(this.createdAt).add(e.hours,"hours").format("YYYY-MM-DDTkk:mm"),5==this.form.priorityStatus&&(this.form.dueDate=null)},setAgents(){this.getAgents(this.form.department),this.form.agent=null,this.form.ticketStatus=1},setAgent(){1==this.form.ticketStatus&&(this.form.ticketStatus=2),this.form.agent||(this.form.ticketStatus=1)},validDueDate(t){return t!=this.invalidDueDateText||"Invalid Date"},async onSubmit(){if(this.$refs.form.validate()&&!this.loadingForm&&(this.confirmationDialog=!1,await this.updateRecord([this.id,this.form]),!(0,r.n)(this.errors))){let t="";Object.entries(this.errors).forEach((([e,i])=>{i&&(t||(t=e),"dueDate"==e&&(this.invalidDueDateText=this.form.dueDate),this.$refs.form.validate(),this.$refs[t].focus())}))}},closeSolutionsDialog(){this.solutionsDialog=!1},closeTicketLogsDialog(){this.ticketLogsDialog=!1},closeConfirmationDialog(){this.confirmationDialog=!1}},filters:{dateFormat(t){return n()(t).format("MMM D, YYYY h:mm A")},setFromNow(t){return n()(t).fromNow()}}},g=v,f=i(1001),h=i(3453),p=i.n(h),_=i(1835),k=i(680),D=i(3237),b=i(7118),x=i(2102),y=i(4228),S=i(1418),w=i(6232),C=i(6428),Z=i(7047),V=i(7003),T=i(2877),A=i(4999),F=i(9762),$=i(5978),L=(0,f.Z)(g,o,s,!1,null,"12f53df5",null),Y=L.exports;p()(L,{VAutocomplete:_.Z,VBtn:k.Z,VCard:D.Z,VCardActions:b.h7,VCardSubtitle:b.Qq,VCardText:b.ZB,VCol:x.Z,VContainer:y.Z,VDivider:S.Z,VForm:w.Z,VIcon:C.Z,VImg:Z.Z,VProgressLinear:V.Z,VRow:T.Z,VSelect:A.Z,VSpacer:F.Z,VTextField:$.Z})},6229:function(t,e,i){t.exports=i.p+"img/default_selfie.aa40bfd1.jpg"}}]);
//# sourceMappingURL=ticketMyTeamEdit.84fd26e5.js.map
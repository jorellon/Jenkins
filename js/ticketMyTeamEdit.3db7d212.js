"use strict";(self["webpackChunkticketing"]=self["webpackChunkticketing"]||[]).push([[844],{9423:function(t,e,i){i.r(e),i.d(e,{default:function(){return Y}});var o=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("v-container",{attrs:{fluid:""}},[o("v-row",[o("v-col",{attrs:{cols:"12",md:"8"}},[o("v-card",[t.loadingRecords?o("div",[o("v-card-text",[o("v-progress-linear",{attrs:{indeterminate:"",color:"grey"}}),o("br"),o("v-progress-linear",{attrs:{indeterminate:"",color:"grey"}}),o("br"),o("v-progress-linear",{attrs:{indeterminate:"",color:"grey"}})],1)],1):o("div",[o("v-card-subtitle",{staticClass:"d-flex"},[o("v-icon",{staticClass:"ml-2 mr-5"},[t._v("mdi-email-outline")]),o("div",[o("h3",{staticClass:"font-weight-black"},[t._v(" Ticket #"+t._s(t.id)+" - "+t._s(t.subject)+" ")]),t._v(" "+t._s(t._f("dateFormat")(t.createdAt))+" ("+t._s(t._f("setFromNow")(t.createdAt))+") ")]),o("v-spacer"),o("router-link",{attrs:{to:{name:"MyTeam"}}},[t._v("Back")])],1),o("v-card-text",{staticClass:"d-flex"},[o("v-img",{staticClass:"mr-3 rounded",attrs:{src:i(6229),"max-height":"40","max-width":"40"}}),o("div",[o("div",{staticClass:"font-weight-bold"},[t._v(t._s(t._f("nameFormat")(t.client)))]),o("div",[t._v(t._s(t.email))]),o("div",{directives:[{name:"show",rawName:"v-show",value:t.loanNumber&&t.project&&t.unit&&t.contact,expression:"loanNumber && project && unit && contact"}]},[o("br"),o("div",[o("span",{staticClass:"font-weight-bold"},[t._v("Loan No.:")]),t._v(" "+t._s(t.loanNumber)+" ")]),o("div",[o("span",{staticClass:"font-weight-bold"},[t._v("Project:")]),t._v(" "+t._s(t.project)+" ")]),o("div",[o("span",{staticClass:"font-weight-bold"},[t._v("Unit/Lot No.:")]),t._v(" "+t._s(t.unit)+" ")]),o("div",[o("span",{staticClass:"font-weight-bold"},[t._v("Contact:")]),t._v(" "+t._s(t.contact)+" ")])])])],1),o("v-card-text",{staticClass:"d-flex"},[o("v-icon",{staticClass:"ml-3 mr-6",attrs:{small:""}},[t._v("mdi-email-outline")]),o("div",{staticClass:"pre-formatted"},[t._v(" "+t._s(t.description)+" ")])],1),o("v-card-actions",[o("v-btn",{staticClass:"text-capitalize ml-15",attrs:{small:""},on:{click:function(e){t.ticketLogsDialog=!0}}},[o("v-icon",{attrs:{small:""}},[t._v("mdi-file-document-outline")]),t._v(" View Logs ")],1),t.isShowSolutionBtn?o("v-btn",{staticClass:"text-capitalize",attrs:{small:""},on:{click:function(e){t.solutionsDialog=!0}}},[o("v-icon",{attrs:{small:""}},[t._v("mdi-book-open-page-variant-outline")]),t._v("  Solution ")],1):t._e()],1)],1)])],1),o("v-col",{attrs:{cols:"12",md:"4"}},[o("v-form",{ref:"form"},[o("v-card",{attrs:{disabled:t.loadingForm}},[o("div",[o("v-card-subtitle",{staticClass:"text-uppercase font-weight-bold"},[t._v(" Properties "),o("v-divider")],1),o("v-card-text",[o("v-row",[o("v-col",{attrs:{cols:"12"}},[o("v-autocomplete",{ref:"category",attrs:{rules:[t.rules.required],items:t.categories,"item-text":"name","item-value":"id",label:"Category","hide-details":"auto"},model:{value:t.form.category,callback:function(e){t.$set(t.form,"category",e)},expression:"form.category"}})],1)],1),o("v-row",[o("v-col",{attrs:{cols:"12"}},[o("v-select",{ref:"ticketStatus",attrs:{rules:[t.rules.required],items:t.ticketStatuses,"item-text":"name","item-value":"id",label:"Status","hide-details":"auto",disabled:""},model:{value:t.form.ticketStatus,callback:function(e){t.$set(t.form,"ticketStatus",e)},expression:"form.ticketStatus"}})],1)],1),o("v-row",[o("v-col",{attrs:{cols:"12"}},[o("v-select",{ref:"priorityStatus",attrs:{rules:[t.rules.required],items:t.priorityStatuses,"item-text":"name","item-value":"id",label:"Priority","hide-details":"auto"},on:{change:function(e){return t.setPriority(t.priorityStatuses)}},scopedSlots:t._u([{key:"selection",fn:function(e){var i=e.item;return[o("v-icon",{staticClass:"mr-1",attrs:{small:"",color:t.getPriorityColor(i.id)}},[t._v("mdi-square")]),t._v(" "+t._s(i.name)+" "),5!=i.id?o("span",[t._v(" ("+t._s(i.hours)+" hrs)")]):t._e()]}},{key:"item",fn:function(e){var i=e.item;return[o("v-icon",{staticClass:"mr-1",attrs:{small:"",color:t.getPriorityColor(i.id)}},[t._v("mdi-square")]),t._v(t._s(i.name)+" "),5!=i.id?o("span",[t._v(" ("+t._s(i.hours)+" hrs)")]):t._e()]}}]),model:{value:t.form.priorityStatus,callback:function(e){t.$set(t.form,"priorityStatus",e)},expression:"form.priorityStatus"}})],1)],1),o("v-row",[o("v-col",{attrs:{cols:"12"}},[o("v-text-field",{ref:"dueDate",attrs:{label:"Due date*",rules:[t.rules.required,t.validDueDate],type:"datetime-local","hide-details":"auto",disabled:5!=t.form.priorityStatus},model:{value:t.form.dueDate,callback:function(e){t.$set(t.form,"dueDate",e)},expression:"form.dueDate"}})],1)],1),o("v-row",[o("v-col",{attrs:{cols:"12"}},[o("v-autocomplete",{ref:"department",attrs:{rules:[t.rules.required],items:t.departments,"item-text":"name","item-value":"id",label:"Department","hide-details":"auto"},on:{change:t.setAgents},model:{value:t.form.department,callback:function(e){t.$set(t.form,"department",e)},expression:"form.department"}})],1)],1),o("v-row",[o("v-col",{attrs:{cols:"12"}},[o("v-autocomplete",{ref:"agent",attrs:{items:t.formatAgentsName,"item-text":"full_name","item-value":"id",label:"Agent","hide-details":"auto"},on:{change:t.setAgent},model:{value:t.form.agent,callback:function(e){t.$set(t.form,"agent",e)},expression:"form.agent"}})],1)],1),o("v-row",[o("v-col",{attrs:{cols:"12"}},[o("v-btn",{attrs:{color:"primary",block:""},on:{click:function(e){t.confirmationDialog=!0}}},[t._v(" Update ")])],1)],1)],1)],1)])],1)],1)],1),t.solutionsDialog?o("solutions",{on:{closeSolutionsDialog:t.closeSolutionsDialog}}):t._e(),t.ticketLogsDialog?o("ticket-logs",{on:{closeTicketLogsDialog:t.closeTicketLogsDialog}}):t._e(),t.confirmationDialog?o("confirmation-message",{attrs:{confirmationData:t.confirmationData},on:{closeConfirmationDialog:t.closeConfirmationDialog,onSubmit:t.onSubmit}}):t._e()],1)},r=[],s=i(629),a=i(2157),l=i(2929),n=i(381),c=i.n(n),d=i(3659),u=i(897),m=i(4439),v=i(5081),f={components:{TicketLogs:m.Z,Solutions:u.Z,ConfirmationMessage:v.Z},data:()=>({rules:d.Z,subject:null,createdAt:null,client:null,email:null,loanNumber:null,project:null,unit:null,contact:null,description:null,id:null,form:{category:null,ticketStatus:null,priorityStatus:null,department:null,agent:null,dueDate:null},solutionsDialog:!1,ticketLogsDialog:!1,isShowSolutionBtn:!1,confirmationDialog:!1,confirmationData:{title:"Are you sure you want to update?",text:"This action cannot be undone.",closeBtnText:"Cancel",closeBtnColor:"gray",saveBtnText:"Update",saveBtnColor:"primary"},invalidDueDateText:null}),created(){this.getRecord()},computed:{...(0,s.rn)("myTeam",["loadingRecords","loadingForm","record","categories","ticketStatuses","priorityStatuses","departments","agents","errors"]),formatAgentsName(){return(0,l.K)(this.agents)}},methods:{...(0,s.nv)("myTeam",["getAgents","editRecord","updateRecord"]),async getRecord(){this.$store.commit("myTeam/setRecord",[]),this.$store.commit("myTeam/setAgents",[]),await this.editRecord(this.$route.params.id),Object.keys(this.record).length&&(this.id=this.record.id,this.subject=this.record.subject,this.createdAt=this.record.created_at,this.client=this.record.client,this.email=this.record.email,this.loanNumber=this.record.loan_number,this.project=this.record.project,this.unit=this.record.unit,this.contact=this.record.contact,this.description=this.record.description,this.form.category=this.record.category_id,this.form.ticketStatus=this.record.ticket_status_id,this.form.priorityStatus=this.record.priority_status_id,this.form.dueDate=c()(this.record.due_date).format("YYYY-MM-DDTkk:mm"),this.form.department=this.record.department_id,this.form.agent=this.record.assigned_to,4!=this.record.ticket_status_id&&5!=this.record.ticket_status_id||(this.isShowSolutionBtn=!0))},getPriorityColor(t){switch(t){case 1:return"green";case 2:return"blue";case 3:return"orange";case 4:return"red";default:return"grey"}},setPriority(t){const e=t.find((t=>t.id===this.form.priorityStatus));this.form.dueDate=c()(this.createdAt).add(e.hours,"hours").format("YYYY-MM-DDTkk:mm"),5==this.form.priorityStatus&&(this.form.dueDate=null)},setAgents(){this.getAgents(this.form.department),this.form.agent=null,this.form.ticketStatus=1},setAgent(){1==this.form.ticketStatus&&(this.form.ticketStatus=2),this.form.agent||(this.form.ticketStatus=1)},validDueDate(t){return t!=this.invalidDueDateText||"Invalid Date"},async onSubmit(){if(this.$refs.form.validate()&&!this.loadingForm){if(this.confirmationDialog=!1,await this.updateRecord([this.id,this.form]),!(0,a.n)(this.errors)){let t="";Object.entries(this.errors).forEach((([e,i])=>{i&&(t||(t=e),"dueDate"==e&&(this.invalidDueDateText=this.form.dueDate),this.$refs.form.validate(),this.$refs[t].focus())}))}null!=this.form.agent&&this.$router.push({name:"MyTeam"})}},closeSolutionsDialog(){this.solutionsDialog=!1},closeTicketLogsDialog(){this.ticketLogsDialog=!1},closeConfirmationDialog(){this.confirmationDialog=!1}},filters:{dateFormat(t){return c()(t).format("MMM D, YYYY h:mm A")},setFromNow(t){return c()(t).fromNow()},nameFormat(t){return(0,l.g)(t)}}},h=f,g=i(1001),p=i(3453),_=i.n(p),D=i(1835),b=i(680),k=i(3237),y=i(7118),S=i(2102),C=i(4228),x=i(1418),w=i(6232),T=i(6428),Z=i(7047),A=i(7003),V=i(2877),$=i(4999),j=i(9762),N=i(5978),L=(0,g.Z)(h,o,r,!1,null,"14253320",null),Y=L.exports;_()(L,{VAutocomplete:D.Z,VBtn:b.Z,VCard:k.Z,VCardActions:y.h7,VCardSubtitle:y.Qq,VCardText:y.ZB,VCol:S.Z,VContainer:C.Z,VDivider:x.Z,VForm:w.Z,VIcon:T.Z,VImg:Z.Z,VProgressLinear:A.Z,VRow:V.Z,VSelect:$.Z,VSpacer:j.Z,VTextField:N.Z})}}]);
//# sourceMappingURL=ticketMyTeamEdit.3db7d212.js.map